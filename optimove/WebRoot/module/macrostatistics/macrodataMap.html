<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<script type="text/javascript"
			src="http://api.map.baidu.com/api?v=2.0&ak=AldpuCo6zS8f7BQnfImd6bx9">
</script>
		<script type="text/javascript"
			src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js">
</script>
		<title>热力图功能示例</title>
		<style type="text/css">
ul,li {
	list-style: none;
	margin: 0;
	padding: 0;
	float: left;
}

html {
	height: 100%
}

body {
	height: 100%;
	margin: 0px;
	padding: 0px;
	font-family: "微软雅黑";
}

#container {
	height: 500px;
	width: 100%;
}

#r-result {
	width: 100%;
}
</style>
	</head>
	<body>
		<div id="container"></div>
	</body>
</html>
<script type="text/javascript">
var map = new BMap.Map("container"); // 创建地图实例

var point = new BMap.Point(114.418261, 25.921984);
map.centerAndZoom(point, 15); // 初始化地图，设置中心点坐标和地图级别
map.enableScrollWheelZoom(); // 允许滚轮缩放

var points = [ {
	"lng" : 114.418261,
	"lat" : 25.921984,
	"count" : 50
}, {
	"lng" : 114.423332,
	"lat" : 25.916532,
	"count" : 51
}, {
	"lng" : 114.419787,
	"lat" : 25.930658,
	"count" : 15
}, {
	"lng" : 114.418455,
	"lat" : 25.920921,
	"count" : 40
}, {
	"lng" : 114.418843,
	"lat" : 25.915516,
	"count" : 100
}, {
	"lng" : 114.42546,
	"lat" : 25.918503,
	"count" : 6
}, {
	"lng" : 114.423289,
	"lat" : 25.919989,
	"count" : 18
}, {
	"lng" : 114.418162,
	"lat" : 25.915051,
	"count" : 80
}, {
	"lng" : 114.422039,
	"lat" : 25.91782,
	"count" : 11
}, {
	"lng" : 114.41387,
	"lat" : 25.917253,
	"count" : 7
}, {
	"lng" : 114.41773,
	"lat" : 25.919426,
	"count" : 42
}, {
	"lng" : 114.421107,
	"lat" : 25.916445,
	"count" : 4
}, {
	"lng" : 114.417521,
	"lat" : 25.917943,
	"count" : 27
}, {
	"lng" : 114.419812,
	"lat" : 25.920836,
	"count" : 23
}, {
	"lng" : 114.420682,
	"lat" : 25.91463,
	"count" : 60
}, {
	"lng" : 114.415424,
	"lat" : 25.924675,
	"count" : 8
}, {
	"lng" : 114.419242,
	"lat" : 25.914509,
	"count" : 15
}, {
	"lng" : 114.422766,
	"lat" : 25.921408,
	"count" : 25
}, {
	"lng" : 114.421674,
	"lat" : 25.924396,
	"count" : 21
}, {
	"lng" : 114.427268,
	"lat" : 25.92267,
	"count" : 1
}, {
	"lng" : 114.417721,
	"lat" : 25.920034,
	"count" : 51
}, {
	"lng" : 114.412456,
	"lat" : 25.92667,
	"count" : 7
}, {
	"lng" : 114.420432,
	"lat" : 25.919114,
	"count" : 11
}, {
	"lng" : 114.425013,
	"lat" : 25.921611,
	"count" : 35
}, {
	"lng" : 114.418733,
	"lat" : 25.931037,
	"count" : 22
}, {
	"lng" : 114.419336,
	"lat" : 25.931134,
	"count" : 4
}, {
	"lng" : 114.413557,
	"lat" : 25.923254,
	"count" : 5
}, {
	"lng" : 114.418367,
	"lat" : 25.92943,
	"count" : 3
}, {
	"lng" : 114.424312,
	"lat" : 25.919621,
	"count" : 100
}, {
	"lng" : 114.423874,
	"lat" : 25.919447,
	"count" : 87
}, {
	"lng" : 114.424225,
	"lat" : 25.923091,
	"count" : 32
}, {
	"lng" : 114.417801,
	"lat" : 25.921854,
	"count" : 44
}, {
	"lng" : 114.417129,
	"lat" : 25.928227,
	"count" : 21
}, {
	"lng" : 114.426426,
	"lat" : 25.922286,
	"count" : 80
}, {
	"lng" : 114.421597,
	"lat" : 25.91948,
	"count" : 32
}, {
	"lng" : 114.423895,
	"lat" : 25.920787,
	"count" : 26
}, {
	"lng" : 114.423563,
	"lat" : 25.921197,
	"count" : 17
}, {
	"lng" : 114.417982,
	"lat" : 25.922547,
	"count" : 17
}, {
	"lng" : 114.426126,
	"lat" : 25.921938,
	"count" : 25
}, {
	"lng" : 114.42326,
	"lat" : 25.915782,
	"count" : 100
}, {
	"lng" : 114.419239,
	"lat" : 25.916759,
	"count" : 39
}, {
	"lng" : 114.417185,
	"lat" : 25.929123,
	"count" : 11
}, {
	"lng" : 114.417237,
	"lat" : 25.927518,
	"count" : 9
}, {
	"lng" : 114.417784,
	"lat" : 25.915754,
	"count" : 47
}, {
	"lng" : 114.420193,
	"lat" : 25.917061,
	"count" : 52
}, {
	"lng" : 114.422735,
	"lat" : 25.915619,
	"count" : 100
}, {
	"lng" : 114.418495,
	"lat" : 25.915958,
	"count" : 46
}, {
	"lng" : 114.416292,
	"lat" : 25.931146,
	"count" : 9
}, {
	"lng" : 114.419916,
	"lat" : 25.924055,
	"count" : 8
}, {
	"lng" : 114.42189,
	"lat" : 25.921308,
	"count" : 11
}, {
	"lng" : 114.413765,
	"lat" : 25.929376,
	"count" : 3
}, {
	"lng" : 114.418232,
	"lat" : 25.920348,
	"count" : 50
}, {
	"lng" : 114.417554,
	"lat" : 25.930511,
	"count" : 15
}, {
	"lng" : 114.418568,
	"lat" : 25.918161,
	"count" : 23
}, {
	"lng" : 114.413461,
	"lat" : 25.926306,
	"count" : 3
}, {
	"lng" : 114.42232,
	"lat" : 25.92161,
	"count" : 13
}, {
	"lng" : 114.4174,
	"lat" : 25.928616,
	"count" : 6
}, {
	"lng" : 114.424679,
	"lat" : 25.915499,
	"count" : 21
}, {
	"lng" : 114.42171,
	"lat" : 25.915738,
	"count" : 29
}, {
	"lng" : 114.417836,
	"lat" : 25.916998,
	"count" : 99
}, {
	"lng" : 114.420755,
	"lat" : 25.928001,
	"count" : 10
}, {
	"lng" : 114.414077,
	"lat" : 25.930655,
	"count" : 14
}, {
	"lng" : 114.426092,
	"lat" : 25.922995,
	"count" : 16
}, {
	"lng" : 114.41535,
	"lat" : 25.931054,
	"count" : 15
}, {
	"lng" : 114.413022,
	"lat" : 25.921895,
	"count" : 13
}, {
	"lng" : 114.415551,
	"lat" : 25.913373,
	"count" : 17
}, {
	"lng" : 114.421191,
	"lat" : 25.926572,
	"count" : 31
}, {
	"lng" : 114.419612,
	"lat" : 25.917119,
	"count" : 39
}, {
	"lng" : 114.418237,
	"lat" : 25.921337,
	"count" : 54
}, {
	"lng" : 114.423776,
	"lat" : 25.921919,
	"count" : 26
}, {
	"lng" : 114.417694,
	"lat" : 25.92536,
	"count" : 27
}, {
	"lng" : 114.415377,
	"lat" : 25.914137,
	"count" : 29
}, {
	"lng" : 114.417434,
	"lat" : 25.914394,
	"count" : 43
}, {
	"lng" : 114.42588,
	"lat" : 25.922622,
	"count" : 27
}, {
	"lng" : 114.418345,
	"lat" : 25.919467,
	"count" : 28
}, {
	"lng" : 114.426883,
	"lat" : 25.917171,
	"count" : 23
}, {
	"lng" : 114.423877,
	"lat" : 25.916659,
	"count" : 34
}, {
	"lng" : 114.415712,
	"lat" : 25.915613,
	"count" : 14
}, {
	"lng" : 114.419869,
	"lat" : 25.931416,
	"count" : 112
}, {
	"lng" : 114.416956,
	"lat" : 25.925377,
	"count" : 111
}, {
	"lng" : 114.42066,
	"lat" : 25.925017,
	"count" : 38
}, {
	"lng" : 114.416244,
	"lat" : 25.920215,
	"count" : 91
}, {
	"lng" : 114.41929,
	"lat" : 25.915908,
	"count" : 54
}, {
	"lng" : 114.422114,
	"lat" : 25.919658,
	"count" : 21
}, {
	"lng" : 114.4183,
	"lat" : 25.925015,
	"count" : 15
}, {
	"lng" : 114.421969,
	"lat" : 25.913527,
	"count" : 83
}, {
	"lng" : 114.422936,
	"lat" : 25.921854,
	"count" : 24
}, {
	"lng" : 114.41905,
	"lat" : 25.929217,
	"count" : 82
}, {
	"lng" : 114.424579,
	"lat" : 25.914987,
	"count" : 57
}, {
	"lng" : 114.42076,
	"lat" : 25.915251,
	"count" : 70
}, {
	"lng" : 114.425867,
	"lat" : 25.918989,
	"count" : 88
} ];

if (!isSupportCanvas()) {
	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
}
//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
//参数说明如下:
/* visible 热力图是否显示,默认为true
 * opacity 热力的透明度,1-100
 * radius 势力图的每个点的半径大小   
 * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
 *	{
		.2:'rgb(0, 255, 255)',
		.5:'rgb(0, 110, 255)',
		.8:'rgb(100, 0, 255)'
	}
	其中 key 表示插值的位置, 0~1. 
	    value 为颜色值. 
 */
heatmapOverlay = new BMapLib.HeatmapOverlay( {
	"radius" : 20
});
map.addOverlay(heatmapOverlay);
heatmapOverlay.setDataSet( {
	data : points,
	max : 100
});
//是否显示热力图
heatmapOverlay.show();
//	function closeHeatmap(){
//     heatmapOverlay.hide();
//  }
closeHeatmap();
function setGradient() {
	/*格式如下所示:
	{
		0:'rgb(102, 255, 0)',
	 	.5:'rgb(255, 170, 0)',
	 	1:'rgb(255, 0, 0)'
	}*/
	var gradient = {};
	var colors = document.querySelectorAll("input[type='color']");
	colors = [].slice.call(colors, 0);
	colors.forEach(function(ele) {
		gradient[ele.getAttribute("data-key")] = ele.value;
	});
	heatmapOverlay.setOptions( {
		"gradient" : gradient
	});
}
//判断浏览区是否支持canvas
function isSupportCanvas() {
	var elem = document.createElement('canvas');
	return !!(elem.getContext && elem.getContext('2d'));
}
</script>