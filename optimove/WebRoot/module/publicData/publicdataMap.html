<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<script type="text/javascript"
			src="http://api.map.baidu.com/api?v=2.0&ak=AldpuCo6zS8f7BQnfImd6bx9">
</script>
		<script type="text/javascript"
			src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js">
</script>
		<title>热力图功能示例</title>
		<style type="text/css">
ul,li {
	list-style: none;
	margin: 0;
	padding: 0;
	float: left;
}

html {
	height: 100%
}

body {
	height: 100%;
	margin: 0px;
	padding: 0px;
	font-family: "微软雅黑";
}

#container {
	height: 500px;
	width: 100%;
}

#r-result {
	width: 100%;
}
</style>
	</head>
	<body>
		<div id="container"></div>
	</body>
</html>
<script type="text/javascript">
var map = new BMap.Map("container"); // 创建地图实例

var point = new BMap.Point(117.418261, 23.921984);
map.centerAndZoom(point, 15); // 初始化地图，设置中心点坐标和地图级别
map.enableScrollWheelZoom(); // 允许滚轮缩放

var points = [ {
	"lng" : 117.418261,
	"lat" : 23.921984,
	"count" : 50
}, {
	"lng" : 117.423332,
	"lat" : 23.916532,
	"count" : 51
}, {
	"lng" : 117.419787,
	"lat" : 23.930658,
	"count" : 15
}, {
	"lng" : 117.418455,
	"lat" : 23.920921,
	"count" : 40
}, {
	"lng" : 117.418843,
	"lat" : 23.915516,
	"count" : 100
}, {
	"lng" : 117.42546,
	"lat" : 23.918503,
	"count" : 6
}, {
	"lng" : 117.423289,
	"lat" : 23.919989,
	"count" : 18
}, {
	"lng" : 117.418162,
	"lat" : 23.915051,
	"count" : 80
}, {
	"lng" : 117.422039,
	"lat" : 23.91782,
	"count" : 11
}, {
	"lng" : 117.41387,
	"lat" : 23.917253,
	"count" : 7
}, {
	"lng" : 117.41773,
	"lat" : 23.919426,
	"count" : 42
}, {
	"lng" : 117.421107,
	"lat" : 23.916445,
	"count" : 4
}, {
	"lng" : 117.417521,
	"lat" : 23.917943,
	"count" : 27
}, {
	"lng" : 117.419812,
	"lat" : 23.920836,
	"count" : 23
}, {
	"lng" : 117.420682,
	"lat" : 23.91463,
	"count" : 60
}, {
	"lng" : 117.415424,
	"lat" : 23.924675,
	"count" : 8
}, {
	"lng" : 117.419242,
	"lat" : 23.914509,
	"count" : 15
}, {
	"lng" : 117.422766,
	"lat" : 23.921408,
	"count" : 25
}, {
	"lng" : 117.421674,
	"lat" : 23.924396,
	"count" : 21
}, {
	"lng" : 117.427268,
	"lat" : 23.92267,
	"count" : 1
}, {
	"lng" : 117.417721,
	"lat" : 23.920034,
	"count" : 51
}, {
	"lng" : 117.412456,
	"lat" : 23.92667,
	"count" : 7
}, {
	"lng" : 117.420432,
	"lat" : 23.919114,
	"count" : 11
}, {
	"lng" : 117.425013,
	"lat" : 23.921611,
	"count" : 35
}, {
	"lng" : 117.418733,
	"lat" : 23.931037,
	"count" : 22
}, {
	"lng" : 117.419336,
	"lat" : 23.931134,
	"count" : 4
}, {
	"lng" : 117.413557,
	"lat" : 23.923254,
	"count" : 5
}, {
	"lng" : 117.418367,
	"lat" : 23.92943,
	"count" : 3
}, {
	"lng" : 117.424312,
	"lat" : 23.919621,
	"count" : 100
}, {
	"lng" : 117.423874,
	"lat" : 23.919447,
	"count" : 87
}, {
	"lng" : 117.424225,
	"lat" : 23.923091,
	"count" : 32
}, {
	"lng" : 117.417801,
	"lat" : 23.921854,
	"count" : 44
}, {
	"lng" : 117.417129,
	"lat" : 23.928227,
	"count" : 21
}, {
	"lng" : 117.426426,
	"lat" : 23.922286,
	"count" : 80
}, {
	"lng" : 117.421597,
	"lat" : 23.91948,
	"count" : 32
}, {
	"lng" : 117.423895,
	"lat" : 23.920787,
	"count" : 26
}, {
	"lng" : 117.423563,
	"lat" : 23.921197,
	"count" : 17
}, {
	"lng" : 117.417982,
	"lat" : 23.922547,
	"count" : 17
}, {
	"lng" : 117.426126,
	"lat" : 23.921938,
	"count" : 25
}, {
	"lng" : 117.42326,
	"lat" : 23.915782,
	"count" : 100
}, {
	"lng" : 117.419239,
	"lat" : 23.916759,
	"count" : 39
}, {
	"lng" : 117.417185,
	"lat" : 23.929123,
	"count" : 11
}, {
	"lng" : 117.417237,
	"lat" : 23.927518,
	"count" : 9
}, {
	"lng" : 117.417784,
	"lat" : 23.915754,
	"count" : 47
}, {
	"lng" : 117.420193,
	"lat" : 23.917061,
	"count" : 52
}, {
	"lng" : 117.422735,
	"lat" : 23.915619,
	"count" : 100
}, {
	"lng" : 117.418495,
	"lat" : 23.915958,
	"count" : 46
}, {
	"lng" : 117.416292,
	"lat" : 23.931176,
	"count" : 9
}, {
	"lng" : 117.419916,
	"lat" : 23.924055,
	"count" : 8
}, {
	"lng" : 117.42189,
	"lat" : 23.921308,
	"count" : 11
}, {
	"lng" : 117.413765,
	"lat" : 23.929376,
	"count" : 3
}, {
	"lng" : 117.418232,
	"lat" : 23.920348,
	"count" : 50
}, {
	"lng" : 117.417554,
	"lat" : 23.930511,
	"count" : 15
}, {
	"lng" : 117.418568,
	"lat" : 23.918161,
	"count" : 23
}, {
	"lng" : 117.413461,
	"lat" : 23.926306,
	"count" : 3
}, {
	"lng" : 117.42232,
	"lat" : 23.92161,
	"count" : 13
}, {
	"lng" : 117.4174,
	"lat" : 23.928616,
	"count" : 6
}, {
	"lng" : 117.424679,
	"lat" : 23.915499,
	"count" : 21
}, {
	"lng" : 117.42171,
	"lat" : 23.915738,
	"count" : 29
}, {
	"lng" : 117.417836,
	"lat" : 23.916998,
	"count" : 99
}, {
	"lng" : 117.420755,
	"lat" : 23.928001,
	"count" : 10
}, {
	"lng" : 117.414077,
	"lat" : 23.930655,
	"count" : 14
}, {
	"lng" : 117.426092,
	"lat" : 23.922995,
	"count" : 16
}, {
	"lng" : 117.41535,
	"lat" : 23.931054,
	"count" : 15
}, {
	"lng" : 117.413022,
	"lat" : 23.921895,
	"count" : 13
}, {
	"lng" : 117.415551,
	"lat" : 23.913373,
	"count" : 17
}, {
	"lng" : 117.421191,
	"lat" : 23.926572,
	"count" : 31
}, {
	"lng" : 117.419612,
	"lat" : 23.917119,
	"count" : 39
}, {
	"lng" : 117.418237,
	"lat" : 23.921337,
	"count" : 54
}, {
	"lng" : 117.423776,
	"lat" : 23.921919,
	"count" : 26
}, {
	"lng" : 117.417694,
	"lat" : 23.92536,
	"count" : 27
}, {
	"lng" : 117.415377,
	"lat" : 23.914137,
	"count" : 29
}, {
	"lng" : 117.417434,
	"lat" : 23.914394,
	"count" : 43
}, {
	"lng" : 117.42588,
	"lat" : 23.922622,
	"count" : 27
}, {
	"lng" : 117.418345,
	"lat" : 23.919467,
	"count" : 28
}, {
	"lng" : 117.426883,
	"lat" : 23.917171,
	"count" : 23
}, {
	"lng" : 117.423877,
	"lat" : 23.916659,
	"count" : 34
}, {
	"lng" : 117.415712,
	"lat" : 23.915613,
	"count" : 14
}, {
	"lng" : 117.419869,
	"lat" : 23.931416,
	"count" : 112
}, {
	"lng" : 117.416956,
	"lat" : 23.925377,
	"count" : 111
}, {
	"lng" : 117.42066,
	"lat" : 23.925017,
	"count" : 38
}, {
	"lng" : 117.416244,
	"lat" : 23.920215,
	"count" : 91
}, {
	"lng" : 117.41929,
	"lat" : 23.915908,
	"count" : 54
}, {
	"lng" : 117.422117,
	"lat" : 23.919658,
	"count" : 21
}, {
	"lng" : 117.4183,
	"lat" : 23.925015,
	"count" : 15
}, {
	"lng" : 117.421969,
	"lat" : 23.913527,
	"count" : 83
}, {
	"lng" : 117.422936,
	"lat" : 23.921854,
	"count" : 24
}, {
	"lng" : 117.41905,
	"lat" : 23.929217,
	"count" : 82
}, {
	"lng" : 117.424579,
	"lat" : 23.914987,
	"count" : 57
}, {
	"lng" : 117.42076,
	"lat" : 23.915251,
	"count" : 70
}, {
	"lng" : 117.425867,
	"lat" : 23.918989,
	"count" : 88
} ];

if (!isSupportCanvas()) {
	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
}
//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
//参数说明如下:
/* visible 热力图是否显示,默认为true
 * opacity 热力的透明度,1-100
 * radius 势力图的每个点的半径大小   
 * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
 *	{
		.2:'rgb(0, 255, 255)',
		.5:'rgb(0, 110, 255)',
		.8:'rgb(100, 0, 255)'
	}
	其中 key 表示插值的位置, 0~1. 
	    value 为颜色值. 
 */
heatmapOverlay = new BMapLib.HeatmapOverlay( {
	"radius" : 20
});
map.addOverlay(heatmapOverlay);
heatmapOverlay.setDataSet( {
	data : points,
	max : 100
});
//是否显示热力图
heatmapOverlay.show();
//	function closeHeatmap(){
//     heatmapOverlay.hide();
//  }
closeHeatmap();
function setGradient() {
	/*格式如下所示:
	{
		0:'rgb(102, 255, 0)',
	 	.5:'rgb(255, 170, 0)',
	 	1:'rgb(255, 0, 0)'
	}*/
	var gradient = {};
	var colors = document.querySelectorAll("input[type='color']");
	colors = [].slice.call(colors, 0);
	colors.forEach(function(ele) {
		gradient[ele.getAttribute("data-key")] = ele.value;
	});
	heatmapOverlay.setOptions( {
		"gradient" : gradient
	});
}
//判断浏览区是否支持canvas
function isSupportCanvas() {
	var elem = document.createElement('canvas');
	return !!(elem.getContext && elem.getContext('2d'));
}
</script>