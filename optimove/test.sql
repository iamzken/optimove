CREATE TABLE optiMoveDemo(
 "ID" VARCHAR2(20) NOT NULL,
 "NAME" VARCHAR2(100),
 "ADDRESS" VARCHAR2(200),
 "TELEPHONE" VARCHAR2(50),
 "LOCATION" "MDSYS"."SDO_GEOMETRY"
)LOGGING;


ALTER TABLE optiMoveDemo
 ADD CONSTRAINT "PK_SPATIAL" PRIMARY KEY("ID");
 
 
 select * from USER_SDO_GEOM_METADATA
 
 
 
 INSERT INTO USER_SDO_GEOM_METADATA
  VALUES(
  'optiMoveDemo',
  'location',
  MDSYS.SDO_DIM_ARRAY(
   MDSYS.SDO_DIM_ELEMENT('Longitude',-180,180,10),
   MDSYS.SDO_DIM_ELEMENT('Latitude',-90,90,10)
  ),
  8307
 );
 
 
 
 CREATE INDEX optiMove_IDX
 ON OPTIMOVEDEMO(location)
 INDEXTYPE IS MDSYS.SPATIAL_INDEX;
 
 
 
 INSERT INTO optiMoveDemo
 VALUES(
  'dbeb7ea11eaf2b53a9b7',
  '小肥羊(天河店)',
  '广州市天河区天寿路25号',
  '020-38217746',
  MDSYS.SDO_GEOMETRY(
   2001,
   8307,
   MDSYS.SDO_POINT_TYPE(113.3293658, 23.14338586, 0),
   NULL,
   NULL
  )
 );
 
 
 INSERT INTO optiMoveDemo
 VALUES(
  'ef8393ef6273a72b2f70',
  '山东老家',
  '广州市越秀区合群一马路43号',
  '020-87778983',
  MDSYS.SDO_GEOMETRY(
   2001,
   8307,
   MDSYS.SDO_POINT_TYPE(113.2932474, 23.11883515, 0),
   NULL,
   NULL
  )
 );
 
 
 
 SELECT
  *
FROM (
  SELECT
    A.*, SDO_GEOM.SDO_DISTANCE(A.location,MDSYS.SDO_GEOMETRY(2001,8307,MDSYS.SDO_POINT_TYPE(113.2359818,23.16937253,0),NULL,NULL),1) dist
  FROM
    optiMoveDemo A
  WHERE
    SDO_WITHIN_DISTANCE(A.LOCATION,MDSYS.SDO_GEOMETRY(2001,8307,MDSYS.SDO_POINT_TYPE(113.2359818,23.16937253,0),NULL,NULL),'distance=9000') = 'TRUE'
  ORDER BY A.name
  ) B
 
 
 
 